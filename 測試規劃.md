# æ¸¬è©¦è¦åŠƒ - ç·šä¸Šé»é¤ç³»çµ±

## æ¦‚è¿°

æœ¬æ–‡æª”æä¾›å®Œæ•´çš„æ¸¬è©¦ç­–ç•¥å’Œå¯¦ä½œè¦åŠƒï¼Œæ¶µè“‹å–®å…ƒæ¸¬è©¦ã€æ•´åˆæ¸¬è©¦ã€APIæ¸¬è©¦å’Œç«¯å°ç«¯æ¸¬è©¦ã€‚åŸºæ–¼ç¾æœ‰çš„ä»£ç¢¼çµæ§‹ï¼Œé‡æ–°è¦åŠƒå’Œå¯¦ä½œæ‰€æœ‰æ¸¬è©¦ã€‚

## ğŸ¯ æ¸¬è©¦ç›®æ¨™

1. æå‡ä»£ç¢¼å“è³ªå’Œå¯é æ€§
2. ç¢ºä¿å¤šè§’è‰²ç³»çµ±åŠŸèƒ½æ­£å¸¸
3. é©—è­‰æ ¸å¿ƒæ¥­å‹™é‚è¼¯
4. é˜²æ­¢å›æ­¸éŒ¯èª¤
5. æ”¯æ´æŒçºŒæ•´åˆ/éƒ¨ç½²

## ğŸ“‹ æ¸¬è©¦åˆ†å±¤ç­–ç•¥

### 1. å–®å…ƒæ¸¬è©¦ (Unit Tests) - 70%
**ç›®æ¨™**: æ¸¬è©¦å€‹åˆ¥å‡½å¼ã€çµ„ä»¶çš„ç¨ç«‹åŠŸèƒ½

#### 1.1 å¾Œç«¯æœå‹™å±¤æ¸¬è©¦
**å„ªå…ˆç´š**: ğŸ”´ æœ€é«˜
- **ä½ç½®**: `tests/unit/server/services/`
- **æ¸¬è©¦æ¡†æ¶**: Vitest
- **é‡é»æ¨¡çµ„**:
  - `user/` - ç”¨æˆ¶èªè­‰èˆ‡ç®¡ç†
  - `order/` - è¨‚å–®è™•ç†é‚è¼¯
  - `promotion/` - ä¿ƒéŠ·è¦å‰‡è¨ˆç®—
  - `inventory/` - åº«å­˜ç®¡ç†é‚è¼¯
  - `delivery/` - å¤–é€å¹³å°æ•´åˆ

**å¯¦ä½œè¨ˆåŠƒ**:
```
tests/unit/server/services/
â”œâ”€â”€ user/
â”‚   â”œâ”€â”€ userAuthService.test.js         - ç”¨æˆ¶èªè­‰
â”‚   â”œâ”€â”€ adminAuthService.test.js        - ç®¡ç†å“¡èªè­‰
â”‚   â””â”€â”€ userProfile.test.js             - ç”¨æˆ¶è³‡æ–™ç®¡ç†
â”œâ”€â”€ order/
â”‚   â”œâ”€â”€ orderCustomer.test.js           - é¡§å®¢è¨‚å–®è™•ç†
â”‚   â”œâ”€â”€ orderAdmin.test.js              - ç®¡ç†è¨‚å–®è™•ç†  
â”‚   â””â”€â”€ orderValidation.test.js         - è¨‚å–®é©—è­‰é‚è¼¯
â”œâ”€â”€ promotion/
â”‚   â”œâ”€â”€ couponService.test.js           - å„ªæƒ åˆ¸è¨ˆç®—
â”‚   â”œâ”€â”€ pointService.test.js            - é»æ•¸ç³»çµ±
â”‚   â””â”€â”€ voucherService.test.js          - ä»£é‡‘åˆ¸é‚è¼¯
â”œâ”€â”€ inventory/
â”‚   â”œâ”€â”€ stockManagement.test.js         - åº«å­˜ç®¡ç†
â”‚   â””â”€â”€ stockStats.test.js              - åº«å­˜çµ±è¨ˆ
â”œâ”€â”€ delivery/
â”‚   â”œâ”€â”€ ubereatsService.test.js         - UberEatsæ•´åˆ
â”‚   â”œâ”€â”€ tokenManager.test.js            - Tokenç®¡ç†
â”‚   â””â”€â”€ orderSyncService.test.js        - è¨‚å–®åŒæ­¥
â””â”€â”€ bundle/
    â”œâ”€â”€ bundleService.test.js           - å¥—é¤è¨ˆç®—
    â””â”€â”€ bundleInstance.test.js          - å¥—é¤å¯¦ä¾‹
```

#### 1.2 å‰ç«¯çµ„ä»¶æ¸¬è©¦
**å„ªå…ˆç´š**: ğŸŸ¡ ä¸­ç­‰
- **ä½ç½®**: `tests/unit/components/`
- **æ¸¬è©¦æ¡†æ¶**: Vitest + Vue Test Utils
- **é‡é»çµ„ä»¶**:

```
tests/unit/components/
â”œâ”€â”€ common/                             - å…±ç”¨çµ„ä»¶
â”‚   â”œâ”€â”€ ConfirmModal.test.js
â”‚   â””â”€â”€ CollapsibleSection.test.js
â”œâ”€â”€ customer/                           - é¡§å®¢ä»‹é¢
â”‚   â”œâ”€â”€ cart/
â”‚   â”‚   â”œâ”€â”€ CartItem.test.js
â”‚   â”‚   â”œâ”€â”€ CouponCard.test.js
â”‚   â”‚   â””â”€â”€ VoucherCard.test.js
â”‚   â”œâ”€â”€ menu/
â”‚   â”‚   â”œâ”€â”€ MenuItemCard.test.js
â”‚   â”‚   â””â”€â”€ CategoryNavigator.test.js
â”‚   â””â”€â”€ auth/
â”‚       â”œâ”€â”€ Login.test.js
â”‚       â””â”€â”€ Register.test.js
â”œâ”€â”€ counter/                            - POSç³»çµ±
â”‚   â”œâ”€â”€ OrderCart/
â”‚   â”‚   â”œâ”€â”€ ShoppingCart.test.js
â”‚   â”‚   â””â”€â”€ OrderDetails.test.js
â”‚   â””â”€â”€ modals/
â”‚       â”œâ”€â”€ CheckoutModal.test.js
â”‚       â””â”€â”€ CashCalculatorModal.test.js
â””â”€â”€ BrandAdmin/                         - å“ç‰Œç®¡ç†
    â”œâ”€â”€ Order/
    â”‚   â”œâ”€â”€ OrderList.test.js
    â”‚   â””â”€â”€ OrderDetailModal.test.js
    â”œâ”€â”€ Menu/
    â”‚   â”œâ”€â”€ MenuList.test.js
    â”‚   â””â”€â”€ MenuForm.test.js
    â””â”€â”€ Store/
        â”œâ”€â”€ StoreList.test.js
        â””â”€â”€ StoreForm.test.js
```

#### 1.3 å‰ç«¯APIæ¨¡çµ„æ¸¬è©¦
**å„ªå…ˆç´š**: ğŸŸ¡ ä¸­ç­‰
- **ä½ç½®**: `tests/unit/api/`
- **é‡é»**: æ¸¬è©¦APIå‘¼å«é‚è¼¯å’ŒéŒ¯èª¤è™•ç†

### 2. æ•´åˆæ¸¬è©¦ (Integration Tests) - 20%
**ç›®æ¨™**: æ¸¬è©¦æ¨¡çµ„é–“çš„å”ä½œ

#### 2.1 APIè·¯ç”±æ•´åˆæ¸¬è©¦
**å„ªå…ˆç´š**: ğŸ”´ æœ€é«˜
- **ä½ç½®**: `tests/integration/api/`
- **æ¸¬è©¦æ¡†æ¶**: Vitest + Supertest

```
tests/integration/api/
â”œâ”€â”€ auth.integration.test.js            - èªè­‰æµç¨‹
â”œâ”€â”€ order.integration.test.js           - è¨‚å–®å®Œæ•´æµç¨‹
â”œâ”€â”€ menu.integration.test.js            - èœå–®ç®¡ç†
â”œâ”€â”€ promotion.integration.test.js       - ä¿ƒéŠ·ç³»çµ±
â”œâ”€â”€ inventory.integration.test.js       - åº«å­˜æ“ä½œ
â””â”€â”€ delivery.integration.test.js        - å¤–é€å¹³å°æ•´åˆ
```

#### 2.2 è³‡æ–™åº«æ•´åˆæ¸¬è©¦
**å„ªå…ˆç´š**: ğŸŸ¡ ä¸­ç­‰
- **ä½ç½®**: `tests/integration/database/`
- **é‡é»**: Modelé—œè¯ã€äº‹å‹™è™•ç†

### 3. APIæ¸¬è©¦ (API Tests) - 5%
**ç›®æ¨™**: é©—è­‰APIç«¯é»æ­£ç¢ºæ€§

#### 3.1 æ ¸å¿ƒAPIæ¸¬è©¦
**å„ªå…ˆç´š**: ğŸ”´ æœ€é«˜
```
tests/api/
â”œâ”€â”€ auth/                               - èªè­‰ç›¸é—œ
â”‚   â”œâ”€â”€ user-login.api.test.js
â”‚   â”œâ”€â”€ admin-login.api.test.js
â”‚   â””â”€â”€ password-reset.api.test.js
â”œâ”€â”€ order/                              - è¨‚å–®ç›¸é—œ
â”‚   â”œâ”€â”€ create-order.api.test.js
â”‚   â”œâ”€â”€ cancel-order.api.test.js
â”‚   â””â”€â”€ order-status.api.test.js
â”œâ”€â”€ menu/                               - èœå–®ç›¸é—œ
â”‚   â”œâ”€â”€ menu-crud.api.test.js
â”‚   â””â”€â”€ dish-crud.api.test.js
â””â”€â”€ admin/                              - ç®¡ç†åŠŸèƒ½
    â”œâ”€â”€ store-management.api.test.js
    â””â”€â”€ user-management.api.test.js
```

### 4. ç«¯å°ç«¯æ¸¬è©¦ (E2E Tests) - 5%
**ç›®æ¨™**: æ¨¡æ“¬çœŸå¯¦ç”¨æˆ¶æ“ä½œæµç¨‹

#### 4.1 é—œéµç”¨æˆ¶æµç¨‹
**å„ªå…ˆç´š**: ğŸ”´ æœ€é«˜
- **ä½ç½®**: `cypress/e2e/`
- **æ¸¬è©¦æ¡†æ¶**: Cypress

```
cypress/e2e/
â”œâ”€â”€ customer/                           - é¡§å®¢æµç¨‹
â”‚   â”œâ”€â”€ order-flow.cy.js               - å®Œæ•´é»é¤æµç¨‹
â”‚   â”œâ”€â”€ member-registration.cy.js       - æœƒå“¡è¨»å†Š
â”‚   â”œâ”€â”€ coupon-usage.cy.js             - å„ªæƒ åˆ¸ä½¿ç”¨
â”‚   â””â”€â”€ order-history.cy.js            - è¨‚å–®æ­·å²
â”œâ”€â”€ admin/                              - ç®¡ç†æµç¨‹
â”‚   â”œâ”€â”€ login.cy.js                     - ç®¡ç†å“¡ç™»å…¥
â”‚   â”œâ”€â”€ store-management.cy.js          - åº—èˆ–ç®¡ç†
â”‚   â”œâ”€â”€ menu-management.cy.js           - èœå–®ç®¡ç†
â”‚   â”œâ”€â”€ order-management.cy.js          - è¨‚å–®ç®¡ç†
â”‚   â””â”€â”€ promotion-management.cy.js      - ä¿ƒéŠ·ç®¡ç†
â”œâ”€â”€ counter/                            - POSç³»çµ±
â”‚   â”œâ”€â”€ pos-ordering.cy.js             - POSé»é¤
â”‚   â”œâ”€â”€ cash-payment.cy.js             - ç¾é‡‘çµå¸³
â”‚   â””â”€â”€ inventory-check.cy.js          - åº«å­˜æª¢æŸ¥
â””â”€â”€ boss/                              - ç³»çµ±ç®¡ç†
    â”œâ”€â”€ brand-management.cy.js
    â””â”€â”€ admin-user-management.cy.js
```

## ğŸš€ å¯¦ä½œéšæ®µè¦åŠƒ

### éšæ®µä¸€ï¼šåŸºç¤å»ºè¨­ (ç¬¬1-2é€±)
**å„ªå…ˆç´š**: ğŸ”´ æœ€é«˜

1. **æ¸…ç†ç¾æœ‰æ¸¬è©¦**
   - ç§»é™¤éæ™‚æ¸¬è©¦æª”æ¡ˆ
   - æ›´æ–°æ¸¬è©¦è¨­ç½®æª”æ¡ˆ
   - ç¢ºèªæ¸¬è©¦ç’°å¢ƒé…ç½®

2. **å»ºç«‹æ¸¬è©¦å·¥å…·**
   - å‰µå»ºæ¸¬è©¦è¼”åŠ©å‡½å¼
   - è¨­ç½®è³‡æ–™mockå·¥å…·
   - å»ºç«‹æ¸¬è©¦è³‡æ–™å·¥å» 

3. **æ ¸å¿ƒæœå‹™æ¸¬è©¦**
   - èªè­‰æœå‹™æ¸¬è©¦
   - è¨‚å–®æ ¸å¿ƒé‚è¼¯æ¸¬è©¦
   - åº«å­˜ç®¡ç†æ¸¬è©¦

### éšæ®µäºŒï¼šAPIèˆ‡æ•´åˆæ¸¬è©¦ (ç¬¬3-4é€±)
**å„ªå…ˆç´š**: ğŸŸ¡ ä¸­ç­‰

1. **APIç«¯é»æ¸¬è©¦**
   - èªè­‰ç›¸é—œAPI
   - è¨‚å–®ç›¸é—œAPI
   - èœå–®ç®¡ç†API

2. **æ•´åˆæ¸¬è©¦**
   - è¨‚å–®å®Œæ•´æµç¨‹
   - ä¿ƒéŠ·ç³»çµ±æ•´åˆ
   - å¤–é€å¹³å°æ•´åˆ

### éšæ®µä¸‰ï¼šå‰ç«¯æ¸¬è©¦ (ç¬¬5-6é€±)
**å„ªå…ˆç´š**: ğŸŸ¡ ä¸­ç­‰

1. **é—œéµçµ„ä»¶æ¸¬è©¦**
   - è³¼ç‰©è»Šçµ„ä»¶
   - çµå¸³æµç¨‹çµ„ä»¶
   - ç®¡ç†ä»‹é¢çµ„ä»¶

2. **ç”¨æˆ¶é«”é©—æ¸¬è©¦**
   - è¡¨å–®é©—è­‰
   - éŒ¯èª¤è™•ç†
   - éŸ¿æ‡‰å¼è¨­è¨ˆ

### éšæ®µå››ï¼šE2Eæ¸¬è©¦ (ç¬¬7-8é€±)
**å„ªå…ˆç´š**: ğŸŸ¢ ä½ç­‰

1. **æ ¸å¿ƒç”¨æˆ¶æµç¨‹**
   - é¡§å®¢é»é¤æµç¨‹
   - ç®¡ç†å“¡æ“ä½œæµç¨‹
   - POSç³»çµ±æ“ä½œ

2. **è·¨ç€è¦½å™¨æ¸¬è©¦**
   - Chrome/Firefox/Safari
   - è¡Œå‹•è£ç½®æ¸¬è©¦

## ğŸ›  æ¸¬è©¦å·¥å…·èˆ‡é…ç½®

### æ¸¬è©¦æ¡†æ¶é¸æ“‡
- **Vitest**: å–®å…ƒæ¸¬è©¦ã€æ•´åˆæ¸¬è©¦
- **Cypress**: E2Eæ¸¬è©¦
- **Vue Test Utils**: Vueçµ„ä»¶æ¸¬è©¦
- **Supertest**: APIæ¸¬è©¦

### æ¸¬è©¦ç’°å¢ƒè¨­ç½®
```javascript
// tests/setup.js - å¢å¼·ç‰ˆ
import { vi } from 'vitest'
import { createPinia } from 'pinia'
import { createI18n } from 'vue-i18n'

// å…¨åŸŸMockè¨­ç½®
global.vi = vi
global.fetch = vi.fn()

// Vueç”Ÿæ…‹ç³»çµ±Mock
vi.mock('vue-router', () => ({
  useRouter: () => ({
    push: vi.fn(),
    replace: vi.fn(),
    go: vi.fn()
  }),
  useRoute: () => ({
    params: {},
    query: {},
    path: '/'
  })
}))

// æ¸¬è©¦è³‡æ–™å·¥å» 
export class TestDataFactory {
  static createUser() { /* ... */ }
  static createOrder() { /* ... */ }
  static createStore() { /* ... */ }
}
```

### Mockç­–ç•¥
1. **è³‡æ–™åº«**: ä½¿ç”¨MongoDB Memory Serveræˆ–å®Œå…¨Mock
2. **å¤–éƒ¨API**: ä½¿ç”¨MSW (Mock Service Worker)
3. **æª”æ¡ˆç³»çµ±**: Mockæª”æ¡ˆä¸Šå‚³/ä¸‹è¼‰
4. **æ™‚é–“**: Mock Dateå’ŒLuxon

## ğŸ“Š æ¸¬è©¦è¦†è“‹ç‡ç›®æ¨™

### è¦†è“‹ç‡æŒ‡æ¨™
- **æ•´é«”è¦†è“‹ç‡**: â‰¥80%
- **æ¥­å‹™é‚è¼¯**: â‰¥90%
- **APIç«¯é»**: â‰¥85%
- **Vueçµ„ä»¶**: â‰¥70%

### é‡é»ç›£æ§
1. **é—œéµæ¥­å‹™æµç¨‹**: 100%è¦†è“‹
2. **éŒ¯èª¤è™•ç†**: å®Œæ•´æ¸¬è©¦
3. **é‚Šç•Œæ¢ä»¶**: å……åˆ†æ¸¬è©¦
4. **æ¬Šé™æ§åˆ¶**: å®Œæ•´é©—è­‰

## ğŸ“ æ¸¬è©¦è¦ç¯„èˆ‡æœ€ä½³å¯¦è¸

### å‘½åè¦å‰‡
```javascript
// æª”æ¡ˆå‘½å
service.test.js      // æœå‹™å±¤æ¸¬è©¦
component.test.js    // çµ„ä»¶æ¸¬è©¦
feature.cy.js        // E2Eæ¸¬è©¦

// æ¸¬è©¦ç”¨ä¾‹å‘½å
describe('OrderService', () => {
  describe('createOrder', () => {
    it('should create order successfully with valid data', () => {
      // æ¸¬è©¦å…§å®¹
    })
    
    it('should throw error when inventory insufficient', () => {
      // æ¸¬è©¦å…§å®¹
    })
  })
})
```

### æ¸¬è©¦çµæ§‹
```javascript
// AAAæ¨¡å¼ (Arrange, Act, Assert)
it('should calculate order total correctly', () => {
  // Arrange - æº–å‚™æ¸¬è©¦è³‡æ–™
  const order = TestDataFactory.createOrder({
    items: [{ price: 100, quantity: 2 }]
  })
  
  // Act - åŸ·è¡Œæ¸¬è©¦å‹•ä½œ
  const total = OrderService.calculateTotal(order)
  
  // Assert - é©—è­‰çµæœ
  expect(total).toBe(200)
})
```

## ğŸ”§ å¸¸è¦‹å•é¡Œèˆ‡è§£æ±ºæ–¹æ¡ˆ

### 1. Mongoose éˆå¼èª¿ç”¨ Mock å•é¡Œ

**âŒ éŒ¯èª¤åšæ³•:**
```javascript
vi.mock('@server/models/Order/Order.js', () => ({
  default: {
    find: vi.fn().mockReturnThis(),
    sort: vi.fn().mockReturnThis(),
    skip: vi.fn().mockReturnThis(),
    limit: vi.fn().mockReturnThis(),
    lean: vi.fn()
  }
}))
```

**âœ… æ­£ç¢ºåšæ³•:**
```javascript
const mockQueryChain = () => ({
  sort: vi.fn().mockReturnThis(),
  skip: vi.fn().mockReturnThis(),
  limit: vi.fn().mockReturnThis(),
  populate: vi.fn().mockReturnThis(),
  lean: vi.fn()
})

vi.mock('@server/models/Order/Order.js', () => ({
  default: {
    countDocuments: vi.fn(),
    find: vi.fn().mockImplementation(() => mockQueryChain()),
    findOne: vi.fn().mockImplementation(() => mockQueryChain()),
    findById: vi.fn()
  }
}))
```

### 2. å‹•æ…‹å°å…¥é †åºå•é¡Œ

**âœ… æ­£ç¢ºé †åº:**
```javascript
// 1. å…ˆè¨­ç½®æ‰€æœ‰ Mock
vi.mock('@server/models/Order/Order.js', () => ({ ... }))
vi.mock('@server/middlewares/error.js', () => ({ ... }))

// 2. å†å‹•æ…‹å°å…¥æœå‹™å’Œä¾è³´
const orderService = await import('@server/services/order/orderCustomer.js')
const Order = (await import('@server/models/Order/Order.js')).default
const { AppError } = await import('@server/middlewares/error.js')
```

### 3. ä¸åŒé¡å‹çš„ Mock ç­–ç•¥

#### 3.1 æ¨¡å‹å¯¦ä¾‹ + éœæ…‹æ–¹æ³• Mock
```javascript
const mockModel = vi.fn().mockImplementation((data) => ({
  ...data,
  _id: data._id || 'mock-id',
  save: vi.fn().mockResolvedValue(),
  deleteOne: vi.fn().mockResolvedValue()
}))

// éœæ…‹æ–¹æ³•
mockModel.find = vi.fn().mockReturnValue(mockQueryChain())
mockModel.findById = vi.fn()
mockModel.countDocuments = vi.fn()

vi.mock('@server/models/SomeModel.js', () => ({ default: mockModel }))
```

#### 3.2 è¤‡é›œéˆå¼èª¿ç”¨ Mock
```javascript
Admin.findOne.mockReturnValue({
  select: vi.fn().mockReturnValue({
    populate: vi.fn().mockReturnValue({
      populate: vi.fn().mockResolvedValue(mockAdmin)
    })
  })
})
```

### 4. AppError è™•ç†

**âœ… æ¨è–¦åšæ³•:**
```javascript
vi.mock('@server/middlewares/error.js', () => ({
  AppError: class AppError extends Error {
    constructor(message, statusCode = 500) {
      super(message)
      this.statusCode = statusCode
      this.name = 'AppError'
    }
  }
}))
```

### 5. TestDataFactory æ“´å±•æ¨¡å¼

```javascript
// åœ¨æ¸¬è©¦æª”æ¡ˆä¸­æ“´å±• TestDataFactory
TestDataFactory.createCouponTemplate = (overrides = {}) => {
  return {
    _id: '507f1f77bcf86cd799439020',
    name: 'Test Coupon',
    discountType: 'percentage',
    discountValue: 10,
    brandId: '507f1f77bcf86cd799439013',
    isActive: true,
    createdAt: new Date(),
    ...overrides
  }
}

// ä½¿ç”¨ Helper å‡½æ•¸ç°¡åŒ–æ¸¬è©¦è³‡æ–™å‰µå»º
const createMockDishItem = (templateId = 'dish-1', basePrice = 100, quantity = 1) => ({
  dishInstance: {
    templateId,
    name: 'Test Dish',
    basePrice,
    finalPrice: basePrice
  },
  quantity,
  subtotal: basePrice * quantity
})
```

### 6. å‰ç«¯æ¸¬è©¦ç‰¹æ®Šè™•ç†

#### 6.1 Pinia Store è¨­ç½®
```javascript
beforeEach(() => {
  setActivePinia(createPinia())
  cartStore = useCartStore()
})
```

#### 6.2 Window å°è±¡ Mock
```javascript
Object.defineProperty(window, 'sessionStorage', {
  value: {
    getItem: vi.fn(() => null),
    setItem: vi.fn(),
    removeItem: vi.fn(),
    clear: vi.fn()
  },
  writable: true
})
```

#### 6.3 API Mock
```javascript
vi.mock('@/api', () => ({
  default: {
    orderCustomer: {
      createOrder: vi.fn().mockResolvedValue({ orderId: 'test-123' })
    }
  }
}))
```

### 7. éŒ¯èª¤æ¸¬è©¦æœ€ä½³å¯¦è¸

```javascript
// æ¸¬è©¦éŒ¯èª¤æ‹‹å‡º
await expect(
  orderService.createOrder(invalidData)
).rejects.toThrow('è¨‚å–®è³‡æ–™ç„¡æ•ˆ')

// æ¸¬è©¦éŒ¯èª¤é¡å‹
await expect(
  orderService.createOrder(invalidData)
).rejects.toBeInstanceOf(AppError)

// æ¸¬è©¦éŒ¯èª¤è¨Šæ¯åŒ…å«ç‰¹å®šå…§å®¹
await expect(
  orderService.createOrder(invalidData)
).rejects.toThrow(/ç„¡æ•ˆçš„/)
```

### 8. éåŒæ­¥æ“ä½œè™•ç†

```javascript
// ç¢ºä¿ Mock è¿”å› Promise
mockFunction.mockResolvedValue(data)
mockFunction.mockRejectedValue(error)

// æ­£ç¢ºä½¿ç”¨ async/await
it('should handle async operation', async () => {
  const result = await asyncFunction()
  expect(result).toBeDefined()
})
```

### 9. è¤‡é›œå°è±¡æ¯”è¼ƒ

```javascript
// ä½¿ç”¨ toMatchObject é€²è¡Œéƒ¨åˆ†æ¯”è¼ƒ
expect(result).toMatchObject({
  status: 'success',
  data: expect.any(Object)
})

// ä½¿ç”¨ toEqual é€²è¡Œå®Œæ•´æ¯”è¼ƒ
expect(result).toEqual(expectedResult)
```

### 10. æ¸…ç†å’Œé‡ç½®

```javascript
beforeEach(() => {
  vi.clearAllMocks()
  // é‡ç½®ç‰¹å®šç‹€æ…‹
})

afterEach(() => {
  vi.restoreAllMocks()
})
```

## ğŸ¯ æ¸¬è©¦æ’°å¯«æª¢æŸ¥æ¸…å–®

### Mock è¨­ç½®æª¢æŸ¥
- [ ] æ‰€æœ‰å¤–éƒ¨ä¾è³´éƒ½å·²æ­£ç¢º Mock
- [ ] éˆå¼èª¿ç”¨ä½¿ç”¨ mockQueryChain æ¨¡å¼
- [ ] AppError ä½¿ç”¨ class å½¢å¼
- [ ] å‹•æ…‹å°å…¥åœ¨ Mock è¨­ç½®ä¹‹å¾Œ

### æ¸¬è©¦è³‡æ–™æª¢æŸ¥
- [ ] ä½¿ç”¨ TestDataFactory æˆ– Helper å‡½æ•¸
- [ ] æ¸¬è©¦è³‡æ–™å…·æœ‰ä»£è¡¨æ€§
- [ ] é‚Šç•Œæ¢ä»¶æœ‰å°æ‡‰çš„æ¸¬è©¦è³‡æ–™

### æ¸¬è©¦æ¡ˆä¾‹æª¢æŸ¥
- [ ] æ­£å¸¸æƒ…æ³æ¸¬è©¦
- [ ] éŒ¯èª¤æƒ…æ³æ¸¬è©¦
- [ ] é‚Šç•Œæ¢ä»¶æ¸¬è©¦
- [ ] æ¬Šé™æª¢æŸ¥æ¸¬è©¦

### æ–·è¨€æª¢æŸ¥
- [ ] ä½¿ç”¨é©ç•¶çš„ expect æ–¹æ³•
- [ ] éŒ¯èª¤æ¸¬è©¦ä½¿ç”¨ rejects.toThrow
- [ ] éåŒæ­¥æ“ä½œä½¿ç”¨ async/await

## ğŸ”§ åŸ·è¡ŒæŒ‡ä»¤å¢å¼·

æ›´æ–° `package.json` è…³æœ¬ï¼š
```json
{
  "scripts": {
    "test": "vitest",
    "test:unit": "vitest run tests/unit",
    "test:integration": "vitest run tests/integration", 
    "test:api": "vitest run tests/api",
    "test:coverage": "vitest run --coverage",
    "test:watch": "vitest --watch",
    "test:ui": "vitest --ui",
    "test:e2e": "cypress run",
    "test:e2e:open": "cypress open",
    "test:all": "yarn test:unit && yarn test:integration && yarn test:api && yarn test:e2e"
  }
}
```

## ğŸš¦ æŒçºŒæ•´åˆ

### GitHub Actions
```yaml
# .github/workflows/test.yml
name: Tests
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Setup Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '18'
      - name: Install dependencies
        run: yarn install
      - name: Run unit tests
        run: yarn test:unit
      - name: Run integration tests  
        run: yarn test:integration
      - name: Run E2E tests
        run: yarn test:e2e
      - name: Upload coverage
        uses: codecov/codecov-action@v3
```

## ğŸ“ˆ ç›£æ§èˆ‡å ±å‘Š

### æ¸¬è©¦å ±å‘Š
- ä½¿ç”¨ `vitest-sonar-reporter` ç”¢ç”ŸSonarQubeå ±å‘Š
- æ•´åˆ `@vitest/ui` æä¾›è¦–è¦ºåŒ–æ¸¬è©¦ç•Œé¢
- è¨­ç½®æ¸¬è©¦å¤±æ•—é€šçŸ¥

### è¦†è“‹ç‡å ±å‘Š
- HTMLå ±å‘Šï¼šä¾¿æ–¼æœ¬åœ°æŸ¥çœ‹
- JSONå ±å‘Šï¼šä¾¿æ–¼CI/CDæ•´åˆ
- å¾½ç« é¡¯ç¤ºï¼šREADMEä¸­å±•ç¤ºè¦†è“‹ç‡

## ğŸ¯ ä¸‹ä¸€æ­¥è¡Œå‹•

### ç«‹å³é–‹å§‹
1. **è©•ä¼°ç¾æœ‰æ¸¬è©¦**: è­˜åˆ¥å¯ä¿ç•™çš„æ¸¬è©¦
2. **å»ºç«‹åŸºç¤è¨­æ–½**: æ›´æ–°æ¸¬è©¦è¨­ç½®å’Œå·¥å…·
3. **å„ªå…ˆæ¸¬è©¦æ ¸å¿ƒ**: å¾æœ€é‡è¦çš„æ¥­å‹™é‚è¼¯é–‹å§‹

### é•·æœŸç¶­è­·
1. **å®šæœŸæª¢æŸ¥**: æ¯æœˆæª¢æŸ¥æ¸¬è©¦è¦†è“‹ç‡
2. **æ›´æ–°æ¸¬è©¦**: éš¨åŠŸèƒ½æ›´æ–°åŒæ­¥æ¸¬è©¦
3. **æ€§èƒ½ç›£æ§**: ç¢ºä¿æ¸¬è©¦åŸ·è¡Œæ•ˆç‡

---

é€™å€‹æ¸¬è©¦è¦åŠƒå°‡å¹«åŠ©ä½ å»ºç«‹ä¸€å€‹å¥å…¨ã€å¯ç¶­è­·çš„æ¸¬è©¦é«”ç³»ï¼Œç¢ºä¿ä»£ç¢¼å“è³ªä¸¦æ”¯æ´æŒçºŒé–‹ç™¼ã€‚å»ºè­°æŒ‰ç…§å„ªå…ˆç´šé€æ­¥å¯¦ä½œï¼Œé‡é»å…ˆå®Œæˆæ ¸å¿ƒæ¥­å‹™é‚è¼¯çš„æ¸¬è©¦ã€‚